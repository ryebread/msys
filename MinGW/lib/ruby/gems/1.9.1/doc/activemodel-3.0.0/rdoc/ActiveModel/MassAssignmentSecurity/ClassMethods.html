<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

	<title>Module: ActiveModel::MassAssignmentSecurity::ClassMethods</title>

	<link rel="stylesheet" href="../../rdoc.css" type="text/css" media="screen" />

	<script src="../../js/jquery.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../../js/thickbox-compressed.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../../js/quicksearch.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../../js/darkfish.js" type="text/javascript"
		charset="utf-8"></script>

</head>
<body class="module">

	<div id="metadata">
		<div id="home-metadata">
			<div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../../index.html">Home</a>
          <a href="../../index.html#classes">Classes</a>
          <a href="../../index.html#methods">Methods</a>
        </h3>
			</div>
		</div>

		<div id="file-metadata">
			<div id="file-list-section" class="section">
				<h3 class="section-header">In Files</h3>
				<div class="section-body">
					<ul>
					
						<li><a href="../../lib/active_model/mass_assignment_security_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/active_model/mass_assignment_security.rb">lib/active_model/mass_assignment_security.rb</a></li>
					
					</ul>
				</div>
			</div>

			
		</div>

		<div id="class-metadata">

			<!-- Parent Class -->
			

			<!-- Namespace Contents -->
			

			<!-- Method Quickref -->
			
			<div id="method-list-section" class="section">
				<h3 class="section-header">Methods</h3>
				<ul class="link-list">
					
					<li><a href="#method-i-accessible_attributes">#accessible_attributes</a></li>
					
					<li><a href="#method-i-active_authorizer">#active_authorizer</a></li>
					
					<li><a href="#method-i-attr_accessible">#attr_accessible</a></li>
					
					<li><a href="#method-i-attr_protected">#attr_protected</a></li>
					
					<li><a href="#method-i-attributes_protected_by_default">#attributes_protected_by_default</a></li>
					
					<li><a href="#method-i-protected_attributes">#protected_attributes</a></li>
					
				</ul>
			</div>
			

			<!-- Included Modules -->
			
		</div>

		<div id="project-metadata">
			
			

			<div id="classindex-section" class="section project-section">
				<h3 class="section-header">Class Index
					<span class="search-toggle"><img src="../../images/find.png"
						height="16" width="16" alt="[+]"
						title="show/hide quicksearch" /></span></h3>
				<form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
				<fieldset>
					<legend>Quicksearch</legend>
					<input type="text" name="quicksearch" value=""
						class="quicksearch-field" />
				</fieldset>
				</form>

				<ul class="link-list">
				
					<li><a href="../../ActiveModel/AttributeMethods.html">ActiveModel::AttributeMethods</a></li>
				
					<li><a href="../../ActiveModel/AttributeMethods/ClassMethods.html">ActiveModel::AttributeMethods::ClassMethods</a></li>
				
					<li><a href="../../ActiveModel/AttributeMethods/ClassMethods/AttributeMethodMatcher.html">ActiveModel::AttributeMethods::ClassMethods::AttributeMethodMatcher</a></li>
				
					<li><a href="../../ActiveModel/BlockValidator.html">ActiveModel::BlockValidator</a></li>
				
					<li><a href="../../ActiveModel/Callbacks.html">ActiveModel::Callbacks</a></li>
				
					<li><a href="../../ActiveModel/Conversion.html">ActiveModel::Conversion</a></li>
				
					<li><a href="../../ActiveModel/DeprecatedErrorMethods.html">ActiveModel::DeprecatedErrorMethods</a></li>
				
					<li><a href="../../ActiveModel/Dirty.html">ActiveModel::Dirty</a></li>
				
					<li><a href="../../ActiveModel/EachValidator.html">ActiveModel::EachValidator</a></li>
				
					<li><a href="../../ActiveModel/Errors.html">ActiveModel::Errors</a></li>
				
					<li><a href="../../ActiveModel/Lint.html">ActiveModel::Lint</a></li>
				
					<li><a href="../../ActiveModel/Lint/Tests.html">ActiveModel::Lint::Tests</a></li>
				
					<li><a href="../../ActiveModel/MassAssignmentSecurity.html">ActiveModel::MassAssignmentSecurity</a></li>
				
					<li><a href="../../ActiveModel/MassAssignmentSecurity/BlackList.html">ActiveModel::MassAssignmentSecurity::BlackList</a></li>
				
					<li><a href="../../ActiveModel/MassAssignmentSecurity/ClassMethods.html">ActiveModel::MassAssignmentSecurity::ClassMethods</a></li>
				
					<li><a href="../../ActiveModel/MassAssignmentSecurity/PermissionSet.html">ActiveModel::MassAssignmentSecurity::PermissionSet</a></li>
				
					<li><a href="../../ActiveModel/MassAssignmentSecurity/Sanitizer.html">ActiveModel::MassAssignmentSecurity::Sanitizer</a></li>
				
					<li><a href="../../ActiveModel/MassAssignmentSecurity/WhiteList.html">ActiveModel::MassAssignmentSecurity::WhiteList</a></li>
				
					<li><a href="../../ActiveModel/MissingAttributeError.html">ActiveModel::MissingAttributeError</a></li>
				
					<li><a href="../../ActiveModel/Name.html">ActiveModel::Name</a></li>
				
					<li><a href="../../ActiveModel/Naming.html">ActiveModel::Naming</a></li>
				
					<li><a href="../../ActiveModel/Observer.html">ActiveModel::Observer</a></li>
				
					<li><a href="../../ActiveModel/Observing.html">ActiveModel::Observing</a></li>
				
					<li><a href="../../ActiveModel/Observing/ClassMethods.html">ActiveModel::Observing::ClassMethods</a></li>
				
					<li><a href="../../ActiveModel/Serialization.html">ActiveModel::Serialization</a></li>
				
					<li><a href="../../ActiveModel/Serializers.html">ActiveModel::Serializers</a></li>
				
					<li><a href="../../ActiveModel/Serializers/JSON.html">ActiveModel::Serializers::JSON</a></li>
				
					<li><a href="../../ActiveModel/Serializers/Xml.html">ActiveModel::Serializers::Xml</a></li>
				
					<li><a href="../../ActiveModel/Translation.html">ActiveModel::Translation</a></li>
				
					<li><a href="../../ActiveModel/Validations.html">ActiveModel::Validations</a></li>
				
					<li><a href="../../ActiveModel/Validations/AcceptanceValidator.html">ActiveModel::Validations::AcceptanceValidator</a></li>
				
					<li><a href="../../ActiveModel/Validations/Callbacks.html">ActiveModel::Validations::Callbacks</a></li>
				
					<li><a href="../../ActiveModel/Validations/Callbacks/ClassMethods.html">ActiveModel::Validations::Callbacks::ClassMethods</a></li>
				
					<li><a href="../../ActiveModel/Validations/ClassMethods.html">ActiveModel::Validations::ClassMethods</a></li>
				
					<li><a href="../../ActiveModel/Validations/ConfirmationValidator.html">ActiveModel::Validations::ConfirmationValidator</a></li>
				
					<li><a href="../../ActiveModel/Validations/ExclusionValidator.html">ActiveModel::Validations::ExclusionValidator</a></li>
				
					<li><a href="../../ActiveModel/Validations/FormatValidator.html">ActiveModel::Validations::FormatValidator</a></li>
				
					<li><a href="../../ActiveModel/Validations/HelperMethods.html">ActiveModel::Validations::HelperMethods</a></li>
				
					<li><a href="../../ActiveModel/Validations/InclusionValidator.html">ActiveModel::Validations::InclusionValidator</a></li>
				
					<li><a href="../../ActiveModel/Validations/LengthValidator.html">ActiveModel::Validations::LengthValidator</a></li>
				
					<li><a href="../../ActiveModel/Validations/NumericalityValidator.html">ActiveModel::Validations::NumericalityValidator</a></li>
				
					<li><a href="../../ActiveModel/Validations/PresenceValidator.html">ActiveModel::Validations::PresenceValidator</a></li>
				
					<li><a href="../../ActiveModel/Validator.html">ActiveModel::Validator</a></li>
				
				</ul>
				<div id="no-class-search-results" style="display: none;">No matching classes.</div>
			</div>

			
		</div>
	</div>

	<div id="documentation">
		<h1 class="module">ActiveModel::MassAssignmentSecurity::ClassMethods</h1>

		<div id="description">
			<p>
Mass assignment security provides an interface for protecting attributes
from end-user assignment. For more complex permissions, mass assignment
security may be handled outside the model by extending a non-ActiveRecord
class, such as a controller, with this behavior.
</p>
<p>
For example, a logged in user may need to assign additional attributes
depending on their role:
</p>
<p>
class AccountsController < ApplicationController
</p>
<pre>
  include ActiveModel::MassAssignmentSecurity

  attr_accessible :first_name, :last_name

  def self.admin_accessible_attributes
    accessible_attributes + [ :plan_id ]
  end

  def update
    ...
    @account.update_attributes(account_params)
    ...
  end

  protected

  def account_params
    sanitize_for_mass_assignment(params[:account])
  end

  def mass_assignment_authorizer
    admin ? admin_accessible_attributes : super
  end
</pre>
<p>
end
</p>

		</div>

		<!-- Constants -->
		

		<!-- Attributes -->
		

		<!-- Methods -->
		
		<div id="public-instance-method-details" class="method-section section">
			<h3 class="section-header">Public Instance Methods</h3>

		
			<div id="accessible-attributes-method" class="method-detail ">
				<a name="method-i-accessible_attributes"></a>

				<div class="method-heading">
				
					<span class="method-name">accessible_attributes</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="accessible-attributes-source">
<pre>
     <span class="ruby-comment cmt"># File lib/active_model/mass_assignment_security.rb, line 137</span>
137:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">accessible_attributes</span>
138:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">_accessible_attributes</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">WhiteList</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">tap</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">w</span><span class="ruby-operator">|</span> <span class="ruby-identifier">w</span>.<span class="ruby-identifier">logger</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">logger</span> <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:logger</span>) }
139:       <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="active-authorizer-method" class="method-detail ">
				<a name="method-i-active_authorizer"></a>

				<div class="method-heading">
				
					<span class="method-name">active_authorizer</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="active-authorizer-source">
<pre>
     <span class="ruby-comment cmt"># File lib/active_model/mass_assignment_security.rb, line 141</span>
141:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">active_authorizer</span>
142:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">_active_authorizer</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">protected_attributes</span>
143:       <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="attr-accessible-method" class="method-detail ">
				<a name="method-i-attr_accessible"></a>

				<div class="method-heading">
				
					<span class="method-name">attr_accessible</span><span
						class="method-args">(*names)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Specifies a white list of model attributes that can be set via
mass-assignment.
</p>
<p>
This is the opposite of the <tt><a
href="ClassMethods.html#method-i-attr_protected">attr_protected</a></tt>
macro: Mass-assignment will only set attributes in this list, to assign to
the rest of attributes you can use direct writer methods. This is meant to
protect sensitive attributes from being overwritten by malicious users
tampering with URLs or forms. If you&#8217;d rather start from an all-open
default and restrict attributes as needed, have a look at <tt><a
href="ClassMethods.html#method-i-attr_protected">attr_protected</a></tt>.
</p>
<pre>
  class Customer
    include ActiveModel::MassAssignmentSecurity

    attr_accessor :name, :credit_rating
    attr_accessible :name

    def attributes=(values)
      sanitize_for_mass_assignment(values).each do |k, v|
        send(&quot;#{k}=&quot;, v)
      end
    end
  end

  customer = Customer.new
  customer.attributes = { :name =&gt; &quot;David&quot;, :credit_rating =&gt; &quot;Excellent&quot; }
  customer.name          # =&gt; &quot;David&quot;
  customer.credit_rating # =&gt; nil

  customer.credit_rating = &quot;Average&quot;
  customer.credit_rating # =&gt; &quot;Average&quot;
</pre>
<p>
Note that using <tt>Hash#except</tt> or <tt>Hash#slice</tt> in place of
<tt><a
href="ClassMethods.html#method-i-attr_accessible">attr_accessible</a></tt>
to sanitize attributes won&#8217;t provide sufficient protection.
</p>
					

					
					<div class="method-source-code"
						id="attr-accessible-source">
<pre>
     <span class="ruby-comment cmt"># File lib/active_model/mass_assignment_security.rb, line 126</span>
126:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">attr_accessible</span>(*<span class="ruby-identifier">names</span>)
127:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">_accessible_attributes</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">accessible_attributes</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">names</span>
128:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">_active_authorizer</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">_accessible_attributes</span>
129:       <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="attr-protected-method" class="method-detail ">
				<a name="method-i-attr_protected"></a>

				<div class="method-heading">
				
					<span class="method-name">attr_protected</span><span
						class="method-args">(*names)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Attributes named in this macro are protected from mass-assignment whenever
attributes are sanitized before assignment.
</p>
<p>
Mass-assignment to these attributes will simply be ignored, to assign to
them you can use direct writer methods. This is meant to protect sensitive
attributes from being overwritten by malicious users tampering with URLs or
forms.
</p>
<h2>Example</h2>
<pre>
  class Customer
    include ActiveModel::MassAssignmentSecurity

    attr_accessor :name, :credit_rating
    attr_protected :credit_rating

    def attributes=(values)
      sanitize_for_mass_assignment(values).each do |k, v|
        send(&quot;#{k}=&quot;, v)
      end
    end
  end

  customer = Customer.new
  customer.attributes = { &quot;name&quot; =&gt; &quot;David&quot;, &quot;credit_rating&quot; =&gt; &quot;Excellent&quot; }
  customer.name          # =&gt; &quot;David&quot;
  customer.credit_rating # =&gt; nil

  customer.credit_rating = &quot;Average&quot;
  customer.credit_rating # =&gt; &quot;Average&quot;
</pre>
<p>
To start from an all-closed default and enable attributes as needed, have a
look at <tt><a
href="ClassMethods.html#method-i-attr_accessible">attr_accessible</a></tt>.
</p>
<p>
Note that using <tt>Hash#except</tt> or <tt>Hash#slice</tt> in place of
<tt><a
href="ClassMethods.html#method-i-attr_protected">attr_protected</a></tt> to
sanitize attributes won&#8217;t provide sufficient protection.
</p>
					

					
					<div class="method-source-code"
						id="attr-protected-source">
<pre>
    <span class="ruby-comment cmt"># File lib/active_model/mass_assignment_security.rb, line 87</span>
87:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">attr_protected</span>(*<span class="ruby-identifier">names</span>)
88:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">_protected_attributes</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">protected_attributes</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">names</span>
89:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">_active_authorizer</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">_protected_attributes</span>
90:       <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="attributes-protected-by-default-method" class="method-detail ">
				<a name="method-i-attributes_protected_by_default"></a>

				<div class="method-heading">
				
					<span class="method-name">attributes_protected_by_default</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="attributes-protected-by-default-source">
<pre>
     <span class="ruby-comment cmt"># File lib/active_model/mass_assignment_security.rb, line 145</span>
145:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">attributes_protected_by_default</span>
146:         []
147:       <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="protected-attributes-method" class="method-detail ">
				<a name="method-i-protected_attributes"></a>

				<div class="method-heading">
				
					<span class="method-name">protected_attributes</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="protected-attributes-source">
<pre>
     <span class="ruby-comment cmt"># File lib/active_model/mass_assignment_security.rb, line 131</span>
131:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">protected_attributes</span>
132:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">_protected_attributes</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">BlackList</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">attributes_protected_by_default</span>).<span class="ruby-identifier">tap</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">w</span><span class="ruby-operator">|</span>
133:           <span class="ruby-identifier">w</span>.<span class="ruby-identifier">logger</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">logger</span> <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:logger</span>)
134:         <span class="ruby-keyword kw">end</span>
135:       <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	

	</div>


	<div id="rdoc-debugging-section-dump" class="debugging-section">
	
		<p>Disabled; run with --debug to generate this.</p>
	
	</div>

	<div id="validator-badges">
		<p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
		<p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
			Rdoc Generator</a> 1.1.6</small>.</p>
	</div>

</body>
</html>

